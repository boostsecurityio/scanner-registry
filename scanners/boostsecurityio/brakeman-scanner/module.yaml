api_version: 1.0

id: boostsecurity-brakeman-scanner
name: Boostsecurity Brakeman Scanner
namespace: boostsecurity-brakeman

config:
  support_diff_scan: true

steps:
  - scan:
      command:
        docker:
          image: presidentbeef/brakeman:latest
          command: --format json --quiet --no-pager --no-exit-on-warn --no-exit-on-error /src
          workdir: /src
      format: sarif
      post-processor:
        docker:
          image: public.ecr.aws/boostsecurityio/boost-scanner-brakeman:89a87a3@sha256:c4627e2bf8567a39f6b5fd950b04ba452841b106a64bca91f0461f6049ae9b60
          command: --interactive
